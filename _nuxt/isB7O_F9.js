import{_ as E}from"./DHBfFcIx.js";import{m as N,r as k,g as $,c as r,x as w,a as t,A as C,N as O,F as A,u as B,B as T,o as n,t as b,_ as F,D as P,E as R,G as j,e as U,b as S,w as I,C as l,O as q,H as L,d as V}from"./BFXac21V.js";import{u as G}from"./Bpe-KHqB.js";import{u as z}from"./DwPDQxx0.js";const J={key:1,class:"modal"},K={class:"modal-controls"},Q=["value"],W=N({__name:"attachHabitModal",props:{habits:Object},emits:["selectionMade"],setup(y,{expose:h,emit:g}){const c=y;if(!c.habits)throw new Error("habits prop is required");const d=k(!1),i=k(""),s=k("");$(i,u=>{if(!c.habits)return;const a=Object.keys(c.habits||{}).find(o=>o===u);if(!a)return;let e=c.habits[a].targetDurationSec.toString();e!="0"?s.value=e:s.value=""});const p=g;function _(){i.value="",s.value=""}function v(){if(!i.value){alert("Please select an option.");return}if(s.value==""||s.value=="0"){alert("Please enter a valid duration.");return}if(s.value==null){alert("Please enter a valid durationx.");return}const u={habitId:i.value,durationSec:parseInt(s.value)};p("selectionMade",u),_(),f()}function M(){d.value=!0}function f(){d.value=!1}return h({openModal:M,closeModal:f}),(u,a)=>(n(),r("div",null,[d.value?(n(),r("div",{key:0,class:"modal-overlay",onClick:f})):w("",!0),d.value?(n(),r("div",J,[a[3]||(a[3]=t("h2",{class:"modal-title"},"Choose an Option",-1)),t("div",K,[C(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e)},[a[2]||(a[2]=t("option",{value:"",disabled:""},"Select...",-1)),(n(!0),r(A,null,B(c.habits,e=>(n(),r("option",{value:e.id},b(e.icon)+" "+b(e.title),9,Q))),256))],512),[[O,i.value]]),C(t("input",{type:"number",class:"input-field","onUpdate:modelValue":a[1]||(a[1]=e=>s.value=e),placeholder:"override duration seconds"},null,512),[[T,s.value]])]),t("button",{class:"submit-button",onClick:v},"Submit")])):w("",!0)]))}}),X=F(W,[["__scopeId","data-v-005eb968"]]),Y={class:"content"},Z={key:0},tt={key:1,class:"cards-container"},et=["index"],at={class:"card-content"},ot={class:"habit-icon"},st={class:"habit-title"},nt={class:"habit-duration"},it={class:"card-actions"},lt=["onClick"],rt={key:2,class:"floating-button"},pt=N({__name:"index",async setup(y){let h,g;const d=P().params.id;if(typeof d!="string")throw[h,g]=R(()=>L("/")),await h,g(),new Error("wrong routine id, not a string");const i=G(),s=i.routines,p=i.routinesLoading,_=j(()=>s.value[d]??null);U(()=>{!p.value&&!s.value[d]&&L("/")});const v=z(),M=v.habitsLoading,f=({habitId:e,durationSec:o})=>{console.log(e,o),i.addHabitInstanceToRoutine(d,e,o)},u=k(null);function a(){u.value?u.value.openModal():console.error("AttachHabitModal is not available yet.")}return(e,o)=>{var H;const x=E;return n(),r("div",Y,[S(x,{class:"back-button",to:"/"},{default:I(()=>o[0]||(o[0]=[V("üîô")])),_:1}),l(p)||l(M)?(n(),r("div",Z,"Loading...")):(n(),r("div",tt,[t("h1",null,b((H=l(_))==null?void 0:H.title),1),(n(!0),r(A,null,B(l(_).habitInstances,(m,D)=>(n(),r("div",{class:"card",key:m.habitInstanceId,index:D},[t("div",at,[t("span",ot,b(l(v).habits.value[m.habitId].icon),1),t("span",st,b(l(v).habits.value[m.habitId].title),1),t("span",nt,b(m.durationSec)+"sec",1)]),t("div",it,[o[1]||(o[1]=t("span",{class:"action-button edit-button"},"üñäÔ∏è",-1)),t("span",{class:"action-button delete-button",onClick:dt=>l(i).removeHabitInstance(l(d),m.habitInstanceId)},"üóëÔ∏è",8,lt)])],8,et))),128)),t("div",{class:"card add-habit-card",onClick:a},o[2]||(o[2]=[t("div",{class:"card-content"},[t("span",{class:"habit-title"},"+ Attach Habit")],-1)]))])),l(p)?(n(),r("div",rt," ‚ñ∂Ô∏è ")):(n(),q(x,{key:3,to:{name:"routines-id-run",params:{id:l(_).id}},class:"floating-button"},{default:I(()=>o[3]||(o[3]=[V(" ‚ñ∂Ô∏è ")])),_:1},8,["to"])),S(X,{habits:l(v).habits.value,ref_key:"attachHabitModal",ref:u,onSelectionMade:f},null,8,["habits"])])}}});export{pt as default};
