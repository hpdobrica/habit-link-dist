import{_ as Bt}from"./CEd7Nx2O.js";import{u as Ct}from"./B4QYOnZY.js";import{D as je,d as ut}from"./Cb9qwsxW.js";import{m as jt,g as It,c as kt,a as rt,b as Rt,F as Ut,o as Lt,_ as xt}from"./XoIZNSvU.js";import"./HnuN2Z5o.js";var Ot={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lt=function(){return lt=Object.assign||function(v){for(var u,b=1,w=arguments.length;b<w;b++){u=arguments[b];for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(v[f]=u[f])}return v},lt.apply(this,arguments)};function et(g,v,u,b){function w(f){return f instanceof u?f:new u(function(o){o(f)})}return new(u||(u=Promise))(function(f,o){function _(N){try{s(b.next(N))}catch(x){o(x)}}function R(N){try{s(b.throw(N))}catch(x){o(x)}}function s(N){N.done?f(N.value):w(N.value).then(_,R)}s((b=b.apply(g,[])).next())})}function We(g,v){var u={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},b,w,f,o;return o={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function _(s){return function(N){return R([s,N])}}function R(s){if(b)throw new TypeError("Generator is already executing.");for(;u;)try{if(b=1,w&&(f=s[0]&2?w.return:s[0]?w.throw||((f=w.return)&&f.call(w),0):w.next)&&!(f=f.call(w,s[1])).done)return f;switch(w=0,f&&(s=[s[0]&2,f.value]),s[0]){case 0:case 1:f=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,w=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(f=u.trys,!(f=f.length>0&&f[f.length-1])&&(s[0]===6||s[0]===2)){u=0;continue}if(s[0]===3&&(!f||s[1]>f[0]&&s[1]<f[3])){u.label=s[1];break}if(s[0]===6&&u.label<f[1]){u.label=f[1],f=s;break}if(f&&u.label<f[2]){u.label=f[2],u.ops.push(s);break}f[2]&&u.ops.pop(),u.trys.pop();continue}s=v.call(g,u)}catch(N){s=[6,N],w=0}finally{b=f=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function Ft(g){var v=[g.schema.primKey].concat(g.schema.indexes);return v.map(function(u){return u.src}).join(",")}function Kt(g){for(var v={},u=0,b=g.tables;u<b.length;u++){var w=b[u];v[w.name]=w.schema}return v}function St(g,v){return new Promise(function(u,b){var w=new FileReader;w.onabort=function(f){return b(new Error("file read aborted"))},w.onerror=function(f){return b(f.target.error)},w.onload=function(f){return u(f.target.result)},v==="binary"?w.readAsArrayBuffer(g):w.readAsText(g)})}function At(g,v){if(typeof FileReaderSync>"u")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var u=new FileReaderSync,b=v==="binary"?u.readAsArrayBuffer(g):u.readAsText(g);return b}var vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wt(g,v){return v={exports:{}},g(v,v.exports),v.exports}var yt=wt(function(g,v){(function(u,b){g.exports=b()})(vt,function(){function u(p){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(y){return typeof y}:u=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},u(p)}function b(p,y,h,d,A,G,H){try{var W=p[G](H),I=W.value}catch(Ae){h(Ae);return}W.done?y(I):Promise.resolve(I).then(d,A)}function w(p){return function(){var y=this,h=arguments;return new Promise(function(d,A){var G=p.apply(y,h);function H(I){b(G,d,A,H,W,"next",I)}function W(I){b(G,d,A,H,W,"throw",I)}H(void 0)})}}function f(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")}function o(p,y){for(var h=0;h<y.length;h++){var d=y[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(p,d.key,d)}}function _(p,y,h){return o(p.prototype,y),p}function R(p,y,h){return y in p?Object.defineProperty(p,y,{value:h,enumerable:!0,configurable:!0,writable:!0}):p[y]=h,p}function s(p,y){var h=Object.keys(p);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(p);y&&(d=d.filter(function(A){return Object.getOwnPropertyDescriptor(p,A).enumerable})),h.push.apply(h,d)}return h}function N(p){for(var y=1;y<arguments.length;y++){var h=arguments[y]!=null?arguments[y]:{};y%2?s(Object(h),!0).forEach(function(d){R(p,d,h[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(h)):s(Object(h)).forEach(function(d){Object.defineProperty(p,d,Object.getOwnPropertyDescriptor(h,d))})}return p}function x(p,y){return V(p)||ee(p,y)||me()}function oe(p){return ye(p)||J(p)||_e()}function ye(p){if(Array.isArray(p)){for(var y=0,h=new Array(p.length);y<p.length;y++)h[y]=p[y];return h}}function V(p){if(Array.isArray(p))return p}function J(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)}function ee(p,y){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]"){var h=[],d=!0,A=!1,G=void 0;try{for(var H=p[Symbol.iterator](),W;!(d=(W=H.next()).done)&&(h.push(W.value),!(y&&h.length===y));d=!0);}catch(I){A=!0,G=I}finally{try{!d&&H.return!=null&&H.return()}finally{if(A)throw G}}return h}}function _e(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function me(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var P=function p(y){f(this,p),this.p=new Promise(y)};P.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(P.prototype[Symbol.toStringTag]="TypesonPromise"),P.prototype.then=function(p,y){var h=this;return new P(function(d,A){h.p.then(function(G){d(p?p(G):G)}).catch(function(G){return y?y(G):Promise.reject(G)}).then(d,A)})},P.prototype.catch=function(p){return this.then(null,p)},P.resolve=function(p){return new P(function(y){y(p)})},P.reject=function(p){return new P(function(y,h){h(p)})},["all","race"].forEach(function(p){P[p]=function(y){return new P(function(h,d){Promise[p](y.map(function(A){return A&&A.constructor&&A.constructor.__typeson__type__==="TypesonPromise"?A.p:A})).then(h,d)})}});var Ne={},K=Ne.toString,ne={}.hasOwnProperty,re=Object.getPrototypeOf,Pe=ne.toString;function c(p,y){return M(p)&&typeof p.then=="function"&&(!y||typeof p.catch=="function")}function r(p){return K.call(p).slice(8,-1)}function m(p,y){if(!p||u(p)!=="object")return!1;var h=re(p);if(!h)return y===null;var d=ne.call(h,"constructor")&&h.constructor;return typeof d!="function"?y===null:y===d||y!==null&&Pe.call(d)===Pe.call(y)||typeof y=="function"&&typeof d.__typeson__type__=="string"&&d.__typeson__type__===y.__typeson__type__}function l(p){if(!p||r(p)!=="Object")return!1;var y=re(p);return y?m(p,Object):!0}function Z(p){if(!p||r(p)!=="Object")return!1;var y=re(p);return y?m(p,Object)||Z(y):!0}function M(p){return p&&u(p)==="object"}function ie(p){return p.replace(/~/g,"~0").replace(/\./g,"~1")}function ve(p){return p.replace(/~1/g,".").replace(/~0/g,"~")}function Se(p,y){if(y==="")return p;var h=y.indexOf(".");if(h>-1){var d=p[ve(y.slice(0,h))];return d===void 0?void 0:Se(d,y.slice(h+1))}return p[ve(y)]}function Ie(p,y,h){if(y==="")return h;var d=y.indexOf(".");if(d>-1){var A=p[ve(y.slice(0,d))];return Ie(A,y.slice(d+1),h)}return p[ve(y)]=h,p}function Ee(p){return p===null?"null":Array.isArray(p)?"array":u(p)}var fe=Object.keys,be=Array.isArray,ke={}.hasOwnProperty,Me=["type","replaced","iterateIn","iterateUnsetNumeric"];function D(p,y){if(p.keypath==="")return-1;var h=p.keypath.match(/\./g)||0,d=y.keypath.match(/\./g)||0;return h&&(h=h.length),d&&(d=d.length),h>d?-1:h<d?1:p.keypath<y.keypath?-1:p.keypath>y.keypath}var de=function(){function p(y){f(this,p),this.options=y,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return _(p,[{key:"stringify",value:function(h,d,A,G){G=N({},this.options,{},G,{stringification:!0});var H=this.encapsulate(h,null,G);return be(H)?JSON.stringify(H[0],d,A):H.then(function(W){return JSON.stringify(W,d,A)})}},{key:"stringifySync",value:function(h,d,A,G){return this.stringify(h,d,A,N({throwOnBadSyncType:!0},G,{sync:!0}))}},{key:"stringifyAsync",value:function(h,d,A,G){return this.stringify(h,d,A,N({throwOnBadSyncType:!0},G,{sync:!1}))}},{key:"parse",value:function(h,d,A){return A=N({},this.options,{},A,{parse:!0}),this.revive(JSON.parse(h,d),A)}},{key:"parseSync",value:function(h,d,A){return this.parse(h,d,N({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"parseAsync",value:function(h,d,A){return this.parse(h,d,N({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"specialTypeNames",value:function(h,d){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A.returnTypeNames=!0,this.encapsulate(h,d,A)}},{key:"rootTypeName",value:function(h,d){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A.iterateNone=!0,this.encapsulate(h,d,A)}},{key:"encapsulate",value:function(h,d,A){A=N({sync:!0},this.options,{},A);var G=A,H=G.sync,W=this,I={},Ae=[],Ue=[],xe=[],Ge="cyclic"in A?A.cyclic:!0,Ye=A,Xe=Ye.encapsulateObserver,Fe=ue("",h,Ge,d||{},xe);function qe(C){var n=Object.values(I);if(A.iterateNone)return n.length?n[0]:p.getJSONType(C);if(n.length){if(A.returnTypeNames)return oe(new Set(n));!C||!l(C)||ke.call(C,"$types")?C={$:C,$types:{$:I}}:C.$types=I}else M(C)&&ke.call(C,"$types")&&(C={$:C,$types:!0});return A.returnTypeNames?!1:C}function ge(C,n){return se.apply(this,arguments)}function se(){return se=w(regeneratorRuntime.mark(function C(n,e){var t;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(e.map(function(O){return O[1].p}));case 2:return t=a.sent,a.next=5,Promise.all(t.map(function(){var O=w(regeneratorRuntime.mark(function T(j){var E,L,Y,q,ae,Q,X,le,pe,$,Te,B,S,U;return regeneratorRuntime.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(E=[],L=e.splice(0,1),Y=x(L,1),q=Y[0],ae=x(q,7),Q=ae[0],X=ae[2],le=ae[3],pe=ae[4],$=ae[5],Te=ae[6],B=ue(Q,j,X,le,E,!0,Te),S=m(B,P),!(Q&&S)){F.next=11;break}return F.next=8,B.p;case 8:return U=F.sent,pe[$]=U,F.abrupt("return",ge(n,E));case 11:return Q?pe[$]=B:S?n=B.p:n=B,F.abrupt("return",ge(n,E));case 13:case"end":return F.stop()}},T)}));return function(T){return O.apply(this,arguments)}}()));case 5:return a.abrupt("return",n);case 6:case"end":return a.stop()}},C)})),se.apply(this,arguments)}function te(C,n,e){Object.assign(C,n);var t=Me.map(function(i){var a=C[i];return delete C[i],a});e(),Me.forEach(function(i,a){C[i]=t[a]})}function ue(C,n,e,t,i,a,O){var T,j={},E=u(n),L=Xe?function(S){var U=O||t.type||p.getJSONType(n);Xe(Object.assign(S||j,{keypath:C,value:n,cyclic:e,stateObj:t,promisesData:i,resolvingTypesonPromise:a,awaitingTypesonPromise:m(n,P)},{type:U}))}:null;if(["string","boolean","number","undefined"].includes(E))return n===void 0||E==="number"&&(isNaN(n)||n===-1/0||n===1/0)?(t.replaced?T=n:T=we(C,n,t,i,!1,a,L),T!==n&&(j={replaced:T})):T=n,L&&L(),T;if(n===null)return L&&L(),n;if(e&&!t.iterateIn&&!t.iterateUnsetNumeric&&n&&u(n)==="object"){var Y=Ae.indexOf(n);if(Y<0)e===!0&&(Ae.push(n),Ue.push(C));else return I[C]="#",L&&L({cyclicKeypath:Ue[Y]}),"#"+Ue[Y]}var q=l(n),ae=be(n),Q=(q||ae)&&(!W.plainObjectReplacers.length||t.replaced)||t.iterateIn?n:we(C,n,t,i,q||ae,null,L),X;if(Q!==n?(T=Q,j={replaced:Q}):C===""&&m(n,P)?(i.push([C,n,e,t,void 0,void 0,t.type]),T=n):ae&&t.iterateIn!=="object"||t.iterateIn==="array"?(X=new Array(n.length),j={clone:X}):!["function","symbol"].includes(u(n))&&!("toJSON"in n)&&!m(n,P)&&!m(n,Promise)&&!m(n,ArrayBuffer)||q||t.iterateIn==="object"?(X={},t.addLength&&(X.length=n.length),j={clone:X}):T=n,L&&L(),A.iterateNone)return X||T;if(!X)return T;if(t.iterateIn){var le=function(U){var k={ownKeys:ke.call(n,U)};te(t,k,function(){var F=C+(C?".":"")+ie(U),z=ue(F,n[U],!!e,t,i,a);m(z,P)?i.push([F,z,!!e,t,X,U,t.type]):z!==void 0&&(X[U]=z)})};for(var pe in n)le(pe);L&&L({endIterateIn:!0,end:!0})}else fe(n).forEach(function(S){var U=C+(C?".":"")+ie(S),k={ownKeys:!0};te(t,k,function(){var F=ue(U,n[S],!!e,t,i,a);m(F,P)?i.push([U,F,!!e,t,X,S,t.type]):F!==void 0&&(X[S]=F)})}),L&&L({endIterateOwn:!0,end:!0});if(t.iterateUnsetNumeric){for(var $=n.length,Te=function(U){if(!(U in n)){var k=C+(C?".":"")+U,F={ownKeys:!1};te(t,F,function(){var z=ue(k,void 0,!!e,t,i,a);m(z,P)?i.push([k,z,!!e,t,X,U,t.type]):z!==void 0&&(X[U]=z)})}},B=0;B<$;B++)Te(B);L&&L({endIterateUnsetNumeric:!0,end:!0})}return X}function we(C,n,e,t,i,a,O){for(var T=i?W.plainObjectReplacers:W.nonplainObjectReplacers,j=T.length;j--;){var E=T[j];if(E.test(n,e)){var L=E.type;if(W.revivers[L]){var Y=I[C];I[C]=Y?[L].concat(Y):L}if(Object.assign(e,{type:L,replaced:!0}),(H||!E.replaceAsync)&&!E.replace)return O&&O({typeDetected:!0}),ue(C,n,Ge&&"readonly",e,t,a,L);O&&O({replacing:!0});var q=H||!E.replaceAsync?"replace":"replaceAsync";return ue(C,E[q](n,e),Ge&&"readonly",e,t,a,L)}}return n}return xe.length?H&&A.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(ge(Fe,xe)).then(qe):!H&&A.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():A.stringification&&H?[qe(Fe)]:H?qe(Fe):Promise.resolve(qe(Fe))}},{key:"encapsulateSync",value:function(h,d,A){return this.encapsulate(h,d,N({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"encapsulateAsync",value:function(h,d,A){return this.encapsulate(h,d,N({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"revive",value:function(h,d){var A=h&&h.$types;if(!A)return h;if(A===!0)return h.$;d=N({sync:!0},this.options,{},d);var G=d,H=G.sync,W=[],I={},Ae=!0;A.$&&l(A.$)&&(h=h.$,A=A.$,Ae=!1);var Ue=this;function xe(se,te){var ue=Ue.revivers[se]||[],we=x(ue,1),C=we[0];if(!C)throw new Error("Unregistered type: "+se);return H&&!("revive"in C)?te:C[H&&C.revive?"revive":!H&&C.reviveAsync?"reviveAsync":"revive"](te,I)}function Ge(){var se=[];if(Object.entries(A).forEach(function(te){var ue=x(te,2),we=ue[0],C=ue[1];C!=="#"&&[].concat(C).forEach(function(n){var e=Ue.revivers[n]||[null,{}],t=x(e,2),i=t[1].plain;i&&(se.push({keypath:we,type:n}),delete A[we])})}),!!se.length)return se.sort(D).reduce(function te(ue,we){var C=we.keypath,n=we.type;if(c(ue))return ue.then(function(i){return te(i,{keypath:C,type:n})});var e=Se(h,C);if(e=xe(n,e),m(e,P))return e.then(function(i){var a=Ie(h,C,i);a===i&&(h=a)});var t=Ie(h,C,e);t===e&&(h=t)},void 0)}var Ye=[];function Xe(se,te,ue,we,C){if(!(Ae&&se==="$types")){var n=A[se],e=be(te);if(e||l(te)){var t=e?new Array(te.length):{};for(fe(te).forEach(function(Y){var q=Xe(se+(se?".":"")+ie(Y),te[Y],ue||t,t,Y),ae=function(X){return m(X,Re)?t[Y]=void 0:X!==void 0&&(t[Y]=X),X};m(q,P)?Ye.push(q.then(function(Q){return ae(Q)})):ae(q)}),te=t;W.length;){var i=x(W[0],4),a=i[0],O=i[1],T=i[2],j=i[3],E=Se(a,O);if(E!==void 0)T[j]=E;else break;W.splice(0,1)}}if(!n)return te;if(n==="#"){var L=Se(ue,te.slice(1));return L===void 0&&W.push([ue,te.slice(1),we,C]),L}return[].concat(n).reduce(function Y(q,ae){return m(q,P)?q.then(function(Q){return Y(Q,ae)}):xe(ae,q)},te)}}function Fe(se){return m(se,Re)?void 0:se}var qe=Ge(),ge;return m(qe,P)?ge=qe.then(function(){return h}):(ge=Xe("",h,null),Ye.length&&(ge=P.resolve(ge).then(function(se){return P.all([se].concat(Ye))}).then(function(se){var te=x(se,1),ue=te[0];return ue}))),c(ge)?H&&d.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():m(ge,P)?ge.p.then(Fe):ge:!H&&d.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():H?Fe(ge):Promise.resolve(Fe(ge))}},{key:"reviveSync",value:function(h,d){return this.revive(h,N({throwOnBadSyncType:!0},d,{sync:!0}))}},{key:"reviveAsync",value:function(h,d){return this.revive(h,N({throwOnBadSyncType:!0},d,{sync:!1}))}},{key:"register",value:function(h,d){return d=d||{},[].concat(h).forEach(function A(G){var H=this;if(be(G))return G.map(function(W){return A.call(H,W)});G&&fe(G).forEach(function(W){if(W==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(p.JSON_TYPES.includes(W))throw new TypeError("Plain JSON object types are reserved as type names");var I=G[W],Ae=I&&I.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Ue=Ae.filter(function(ue){return ue.type===W});if(Ue.length&&(Ae.splice(Ae.indexOf(Ue[0]),1),delete this.revivers[W],delete this.types[W]),typeof I=="function"){var xe=I;I={test:function(we){return we&&we.constructor===xe},replace:function(we){return N({},we)},revive:function(we){return Object.assign(Object.create(xe.prototype),we)}}}else if(be(I)){var Ge=I,Ye=x(Ge,3),Xe=Ye[0],Fe=Ye[1],qe=Ye[2];I={test:Xe,replace:Fe,revive:qe}}if(!(!I||!I.test)){var ge={type:W,test:I.test.bind(I)};I.replace&&(ge.replace=I.replace.bind(I)),I.replaceAsync&&(ge.replaceAsync=I.replaceAsync.bind(I));var se=typeof d.fallback=="number"?d.fallback:d.fallback?0:1/0;if(I.testPlainObjects?this.plainObjectReplacers.splice(se,0,ge):this.nonplainObjectReplacers.splice(se,0,ge),I.revive||I.reviveAsync){var te={};I.revive&&(te.revive=I.revive.bind(I)),I.reviveAsync&&(te.reviveAsync=I.reviveAsync.bind(I)),this.revivers[W]=[te,{plain:I.testPlainObjects}]}this.types[W]=I}},this)},this),this}}]),p}(),Re=function p(){f(this,p)};return Re.__typeson__type__="TypesonUndefined",de.Undefined=Re,de.Promise=P,de.isThenable=c,de.toStringTag=r,de.hasConstructorOf=m,de.isObject=M,de.isPlainObject=l,de.isUserObject=Z,de.escapeKeyPathComponent=ie,de.unescapeKeyPathComponent=ve,de.getByKeyPath=Se,de.getJSONType=Ee,de.JSON_TYPES=["null","boolean","number","string","array","object"],de})}),Dt=wt(function(g,v){(function(u,b){g.exports=b()})(vt,function(){function u(n){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function b(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function w(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function f(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function _(n){return function(t){if(Array.isArray(t))return R(t)}(n)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,i){if(t){if(typeof t=="string")return R(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return R(t,i)}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function R(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function s(n){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function N(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function x(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function oe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ye(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function V(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ye(Object(t),!0).forEach(function(i){oe(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ye(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function J(n,e){return function(i){if(Array.isArray(i))return i}(n)||function(i,a){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var O=[],T=!0,j=!1,E=void 0;try{for(var L,Y=i[Symbol.iterator]();!(T=(L=Y.next()).done)&&(O.push(L.value),!a||O.length!==a);T=!0);}catch(q){j=!0,E=q}finally{try{T||Y.return==null||Y.return()}finally{if(j)throw E}}return O}}(n,e)||_e(n,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ee(n){return function(t){if(Array.isArray(t))return me(t)}(n)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||_e(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function _e(n,e){if(n){if(typeof n=="string")return me(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?me(n,e):void 0}}function me(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}var P=function n(e){N(this,n),this.p=new Promise(e)};P.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(P.prototype[Symbol.toStringTag]="TypesonPromise"),P.prototype.then=function(n,e){var t=this;return new P(function(i,a){t.p.then(function(O){i(n?n(O):O)}).catch(function(O){return e?e(O):Promise.reject(O)}).then(i,a)})},P.prototype.catch=function(n){return this.then(null,n)},P.resolve=function(n){return new P(function(e){e(n)})},P.reject=function(n){return new P(function(e,t){t(n)})},["all","race"].forEach(function(n){P[n]=function(e){return new P(function(t,i){Promise[n](e.map(function(a){return a&&a.constructor&&a.constructor.__typeson__type__==="TypesonPromise"?a.p:a})).then(t,i)})}});var Ne={}.toString,K={}.hasOwnProperty,ne=Object.getPrototypeOf,re=K.toString;function Pe(n,e){return l(n)&&typeof n.then=="function"&&(!e||typeof n.catch=="function")}function c(n){return Ne.call(n).slice(8,-1)}function r(n,e){if(!n||s(n)!=="object")return!1;var t=ne(n);if(!t)return e===null;var i=K.call(t,"constructor")&&t.constructor;return typeof i!="function"?e===null:e===i||e!==null&&re.call(i)===re.call(e)||typeof e=="function"&&typeof i.__typeson__type__=="string"&&i.__typeson__type__===e.__typeson__type__}function m(n){return!(!n||c(n)!=="Object")&&(!ne(n)||r(n,Object))}function l(n){return n&&s(n)==="object"}function Z(n){return n.replace(/~/g,"~0").replace(/\./g,"~1")}function M(n){return n.replace(/~1/g,".").replace(/~0/g,"~")}function ie(n,e){if(e==="")return n;var t=e.indexOf(".");if(t>-1){var i=n[M(e.slice(0,t))];return i===void 0?void 0:ie(i,e.slice(t+1))}return n[M(e)]}function ve(n,e,t){if(e==="")return t;var i=e.indexOf(".");return i>-1?ve(n[M(e.slice(0,i))],e.slice(i+1),t):(n[M(e)]=t,n)}function Se(n,e,t){return n&&n.then||(n=Promise.resolve(n)),e?n.then(e):n}var Ie=Object.keys,Ee=Array.isArray,fe={}.hasOwnProperty,be=["type","replaced","iterateIn","iterateUnsetNumeric"];function ke(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(i){return Promise.reject(i)}}}function Me(n,e){if(n.keypath==="")return-1;var t=n.keypath.match(/\./g)||0,i=e.keypath.match(/\./g)||0;return t&&(t=t.length),i&&(i=i.length),t>i?-1:t<i?1:n.keypath<e.keypath?-1:n.keypath>e.keypath}var D=function(){function n(e){N(this,n),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(t,i,a){return x(t.prototype,i),t}(n,[{key:"stringify",value:function(t,i,a,O){O=V(V(V({},this.options),O),{},{stringification:!0});var T=this.encapsulate(t,null,O);return Ee(T)?JSON.stringify(T[0],i,a):T.then(function(j){return JSON.stringify(j,i,a)})}},{key:"stringifySync",value:function(t,i,a,O){return this.stringify(t,i,a,V(V({throwOnBadSyncType:!0},O),{},{sync:!0}))}},{key:"stringifyAsync",value:function(t,i,a,O){return this.stringify(t,i,a,V(V({throwOnBadSyncType:!0},O),{},{sync:!1}))}},{key:"parse",value:function(t,i,a){return a=V(V(V({},this.options),a),{},{parse:!0}),this.revive(JSON.parse(t,i),a)}},{key:"parseSync",value:function(t,i,a){return this.parse(t,i,V(V({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"parseAsync",value:function(t,i,a){return this.parse(t,i,V(V({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"specialTypeNames",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.returnTypeNames=!0,this.encapsulate(t,i,a)}},{key:"rootTypeName",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.iterateNone=!0,this.encapsulate(t,i,a)}},{key:"encapsulate",value:function(t,i,a){var O=ke(function(B,S){return Se(Promise.all(S.map(function(U){return U[1].p})),function(U){return Se(Promise.all(U.map(ke(function(k){var F=!1,z=[],Ke=J(S.splice(0,1),1),Oe=J(Ke[0],7),Le=Oe[0],$e=Oe[2],ce=Oe[3],Ve=Oe[4],he=Oe[5],De=Oe[6],Be=$(Le,k,$e,ce,z,!0,De),ze=r(Be,P);return function(dt,ot){var nt=dt();return nt&&nt.then?nt.then(ot):ot(nt)}(function(){if(Le&&ze)return Se(Be.p,function(He){return Ve[he]=He,F=!0,O(B,z)})},function(He){return F?He:(Le?Ve[he]=Be:B=ze?Be.p:Be,O(B,z))})}))),function(){return B})})}),T=(a=V(V({sync:!0},this.options),a)).sync,j=this,E={},L=[],Y=[],q=[],ae=!("cyclic"in a)||a.cyclic,Q=a.encapsulateObserver,X=$("",t,ae,i||{},q);function le(B){var S=Object.values(E);if(a.iterateNone)return S.length?S[0]:n.getJSONType(B);if(S.length){if(a.returnTypeNames)return ee(new Set(S));B&&m(B)&&!fe.call(B,"$types")?B.$types=E:B={$:B,$types:{$:E}}}else l(B)&&fe.call(B,"$types")&&(B={$:B,$types:!0});return!a.returnTypeNames&&B}function pe(B,S,U){Object.assign(B,S);var k=be.map(function(F){var z=B[F];return delete B[F],z});U(),be.forEach(function(F,z){B[F]=k[z]})}function $(B,S,U,k,F,z,Ke){var Oe,Le={},$e=s(S),ce=Q?function(Ze){var Ce=Ke||k.type||n.getJSONType(S);Q(Object.assign(Ze||Le,{keypath:B,value:S,cyclic:U,stateObj:k,promisesData:F,resolvingTypesonPromise:z,awaitingTypesonPromise:r(S,P)},{type:Ce}))}:null;if(["string","boolean","number","undefined"].includes($e))return S===void 0||Number.isNaN(S)||S===Number.NEGATIVE_INFINITY||S===Number.POSITIVE_INFINITY?(Oe=k.replaced?S:Te(B,S,k,F,!1,z,ce))!==S&&(Le={replaced:Oe}):Oe=S,ce&&ce(),Oe;if(S===null)return ce&&ce(),S;if(U&&!k.iterateIn&&!k.iterateUnsetNumeric&&S&&s(S)==="object"){var Ve=L.indexOf(S);if(!(Ve<0))return E[B]="#",ce&&ce({cyclicKeypath:Y[Ve]}),"#"+Y[Ve];U===!0&&(L.push(S),Y.push(B))}var he,De=m(S),Be=Ee(S),ze=(De||Be)&&(!j.plainObjectReplacers.length||k.replaced)||k.iterateIn?S:Te(B,S,k,F,De||Be,null,ce);if(ze!==S?(Oe=ze,Le={replaced:ze}):B===""&&r(S,P)?(F.push([B,S,U,k,void 0,void 0,k.type]),Oe=S):Be&&k.iterateIn!=="object"||k.iterateIn==="array"?(he=new Array(S.length),Le={clone:he}):(["function","symbol"].includes(s(S))||"toJSON"in S||r(S,P)||r(S,Promise)||r(S,ArrayBuffer))&&!De&&k.iterateIn!=="object"?Oe=S:(he={},k.addLength&&(he.length=S.length),Le={clone:he}),ce&&ce(),a.iterateNone)return he||Oe;if(!he)return Oe;if(k.iterateIn){var He=function(Ce){var Qe={ownKeys:fe.call(S,Ce)};pe(k,Qe,function(){var tt=B+(B?".":"")+Z(Ce),st=$(tt,S[Ce],!!U,k,F,z);r(st,P)?F.push([tt,st,!!U,k,he,Ce,k.type]):st!==void 0&&(he[Ce]=st)})};for(var dt in S)He(dt);ce&&ce({endIterateIn:!0,end:!0})}else Ie(S).forEach(function(Ze){var Ce=B+(B?".":"")+Z(Ze);pe(k,{ownKeys:!0},function(){var Qe=$(Ce,S[Ze],!!U,k,F,z);r(Qe,P)?F.push([Ce,Qe,!!U,k,he,Ze,k.type]):Qe!==void 0&&(he[Ze]=Qe)})}),ce&&ce({endIterateOwn:!0,end:!0});if(k.iterateUnsetNumeric){for(var ot=S.length,nt=function(Ce){if(!(Ce in S)){var Qe=B+(B?".":"")+Ce;pe(k,{ownKeys:!1},function(){var tt=$(Qe,void 0,!!U,k,F,z);r(tt,P)?F.push([Qe,tt,!!U,k,he,Ce,k.type]):tt!==void 0&&(he[Ce]=tt)})}},ht=0;ht<ot;ht++)nt(ht);ce&&ce({endIterateUnsetNumeric:!0,end:!0})}return he}function Te(B,S,U,k,F,z,Ke){for(var Oe=F?j.plainObjectReplacers:j.nonplainObjectReplacers,Le=Oe.length;Le--;){var $e=Oe[Le];if($e.test(S,U)){var ce=$e.type;if(j.revivers[ce]){var Ve=E[B];E[B]=Ve?[ce].concat(Ve):ce}return Object.assign(U,{type:ce,replaced:!0}),!T&&$e.replaceAsync||$e.replace?(Ke&&Ke({replacing:!0}),$(B,$e[T||!$e.replaceAsync?"replace":"replaceAsync"](S,U),ae&&"readonly",U,k,z,ce)):(Ke&&Ke({typeDetected:!0}),$(B,S,ae&&"readonly",U,k,z,ce))}}return S}return q.length?T&&a.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(O(X,q)).then(le):!T&&a.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():a.stringification&&T?[le(X)]:T?le(X):Promise.resolve(le(X))}},{key:"encapsulateSync",value:function(t,i,a){return this.encapsulate(t,i,V(V({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(t,i,a){return this.encapsulate(t,i,V(V({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"revive",value:function(t,i){var a=t&&t.$types;if(!a)return t;if(a===!0)return t.$;var O=(i=V(V({sync:!0},this.options),i)).sync,T=[],j={},E=!0;a.$&&m(a.$)&&(t=t.$,a=a.$,E=!1);var L=this;function Y(le,pe){var $=J(L.revivers[le]||[],1)[0];if(!$)throw new Error("Unregistered type: "+le);return O&&!("revive"in $)?pe:$[O&&$.revive?"revive":!O&&$.reviveAsync?"reviveAsync":"revive"](pe,j)}var q=[];function ae(le){return r(le,de)?void 0:le}var Q,X=function(){var pe=[];if(Object.entries(a).forEach(function($){var Te=J($,2),B=Te[0],S=Te[1];S!=="#"&&[].concat(S).forEach(function(U){J(L.revivers[U]||[null,{}],2)[1].plain&&(pe.push({keypath:B,type:U}),delete a[B])})}),pe.length)return pe.sort(Me).reduce(function $(Te,B){var S=B.keypath,U=B.type;if(Pe(Te))return Te.then(function(z){return $(z,{keypath:S,type:U})});var k=ie(t,S);if(r(k=Y(U,k),P))return k.then(function(z){var Ke=ve(t,S,z);Ke===z&&(t=Ke)});var F=ve(t,S,k);F===k&&(t=F)},void 0)}();return r(X,P)?Q=X.then(function(){return t}):(Q=function le(pe,$,Te,B,S){if(!E||pe!=="$types"){var U=a[pe],k=Ee($);if(k||m($)){var F=k?new Array($.length):{};for(Ie($).forEach(function(he){var De=le(pe+(pe?".":"")+Z(he),$[he],Te||F,F,he),Be=function(He){return r(He,de)?F[he]=void 0:He!==void 0&&(F[he]=He),He};r(De,P)?q.push(De.then(function(ze){return Be(ze)})):Be(De)}),$=F;T.length;){var z=J(T[0],4),Ke=z[0],Oe=z[1],Le=z[2],$e=z[3],ce=ie(Ke,Oe);if(ce===void 0)break;Le[$e]=ce,T.splice(0,1)}}if(!U)return $;if(U==="#"){var Ve=ie(Te,$.slice(1));return Ve===void 0&&T.push([Te,$.slice(1),B,S]),Ve}return[].concat(U).reduce(function he(De,Be){return r(De,P)?De.then(function(ze){return he(ze,Be)}):Y(Be,De)},$)}}("",t,null),q.length&&(Q=P.resolve(Q).then(function(le){return P.all([le].concat(q))}).then(function(le){return J(le,1)[0]}))),Pe(Q)?O&&i.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():r(Q,P)?Q.p.then(ae):Q:!O&&i.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():O?ae(Q):Promise.resolve(ae(Q))}},{key:"reviveSync",value:function(t,i){return this.revive(t,V(V({throwOnBadSyncType:!0},i),{},{sync:!0}))}},{key:"reviveAsync",value:function(t,i){return this.revive(t,V(V({throwOnBadSyncType:!0},i),{},{sync:!1}))}},{key:"register",value:function(t,i){return i=i||{},[].concat(t).forEach(function a(O){var T=this;if(Ee(O))return O.map(function(j){return a.call(T,j)});O&&Ie(O).forEach(function(j){if(j==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(n.JSON_TYPES.includes(j))throw new TypeError("Plain JSON object types are reserved as type names");var E=O[j],L=E&&E.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Y=L.filter(function(pe){return pe.type===j});if(Y.length&&(L.splice(L.indexOf(Y[0]),1),delete this.revivers[j],delete this.types[j]),typeof E=="function"){var q=E;E={test:function($){return $&&$.constructor===q},replace:function($){return V({},$)},revive:function($){return Object.assign(Object.create(q.prototype),$)}}}else if(Ee(E)){var ae=J(E,3);E={test:ae[0],replace:ae[1],revive:ae[2]}}if(E&&E.test){var Q={type:j,test:E.test.bind(E)};E.replace&&(Q.replace=E.replace.bind(E)),E.replaceAsync&&(Q.replaceAsync=E.replaceAsync.bind(E));var X=typeof i.fallback=="number"?i.fallback:i.fallback?0:Number.POSITIVE_INFINITY;if(E.testPlainObjects?this.plainObjectReplacers.splice(X,0,Q):this.nonplainObjectReplacers.splice(X,0,Q),E.revive||E.reviveAsync){var le={};E.revive&&(le.revive=E.revive.bind(E)),E.reviveAsync&&(le.reviveAsync=E.reviveAsync.bind(E)),this.revivers[j]=[le,{plain:E.testPlainObjects}]}this.types[j]=E}},this)},this),this}}]),n}(),de=function n(){N(this,n)};de.__typeson__type__="TypesonUndefined",D.Undefined=de,D.Promise=P,D.isThenable=Pe,D.toStringTag=c,D.hasConstructorOf=r,D.isObject=l,D.isPlainObject=m,D.isUserObject=function n(e){if(!e||c(e)!=="Object")return!1;var t=ne(e);return!t||r(e,Object)||n(t)},D.escapeKeyPathComponent=Z,D.unescapeKeyPathComponent=M,D.getByKeyPath=ie,D.getJSONType=function(e){return e===null?"null":Array.isArray(e)?"array":s(e)},D.JSON_TYPES=["null","boolean","number","string","array","object"];for(var Re={userObject:{test:function(e,t){return D.isUserObject(e)},replace:function(e){return function(i){for(var a=1;a<arguments.length;a++){var O=arguments[a]!=null?arguments[a]:{};a%2?o(Object(O),!0).forEach(function(T){f(i,T,O[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(O)):o(Object(O)).forEach(function(T){Object.defineProperty(i,T,Object.getOwnPropertyDescriptor(O,T))})}return i}({},e)},revive:function(e){return e}}},p=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(e,t){return!!Array.isArray(e)&&(Object.keys(e).some(function(i){return String(Number.parseInt(i))!==i})&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e},revive:function(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach(function(i){var a=e[i];t[i]=a}),t}}},{sparseUndefined:{test:function(e,t){return e===void 0&&t.ownKeys===!1},replace:function(e){return 0},revive:function(e){}}}],y={undef:{test:function(e,t){return e===void 0&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return 0},revive:function(e){return new D.Undefined}}},h={StringObject:{test:function(e){return D.toStringTag(e)==="String"&&u(e)==="object"},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(e){return D.toStringTag(e)==="Boolean"&&u(e)==="object"},replace:function(e){return!!e},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(e){return D.toStringTag(e)==="Number"&&u(e)==="object"},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},d=[{nan:{test:function(e){return Number.isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return Number.NaN}}},{infinity:{test:function(e){return e===Number.POSITIVE_INFINITY},replace:function(e){return"Infinity"},revive:function(e){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(e){return e===Number.NEGATIVE_INFINITY},replace:function(e){return"-Infinity"},revive:function(e){return Number.NEGATIVE_INFINITY}}}],A={date:{test:function(e){return D.toStringTag(e)==="Date"},replace:function(e){var t=e.getTime();return Number.isNaN(t)?"NaN":t},revive:function(e){return e==="NaN"?new Date(Number.NaN):new Date(e)}}},G={regexp:{test:function(e){return D.toStringTag(e)==="RegExp"},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,i=e.flags;return new RegExp(t,i)}}},H={map:{test:function(e){return D.toStringTag(e)==="Map"},replace:function(e){return _(e.entries())},revive:function(e){return new Map(e)}}},W={set:{test:function(e){return D.toStringTag(e)==="Set"},replace:function(e){return _(e.values())},revive:function(e){return new Set(e)}}},I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae=new Uint8Array(256),Ue=0;Ue<I.length;Ue++)Ae[I.charCodeAt(Ue)]=Ue;var xe=function(e,t,i){i==null&&(i=e.byteLength);for(var a=new Uint8Array(e,0,i),O=a.length,T="",j=0;j<O;j+=3)T+=I[a[j]>>2],T+=I[(3&a[j])<<4|a[j+1]>>4],T+=I[(15&a[j+1])<<2|a[j+2]>>6],T+=I[63&a[j+2]];return O%3==2?T=T.slice(0,-1)+"=":O%3==1&&(T=T.slice(0,-2)+"=="),T},Ge=function(e){var t,i,a,O,T=e.length,j=.75*e.length,E=0;e[e.length-1]==="="&&(j--,e[e.length-2]==="="&&j--);for(var L=new ArrayBuffer(j),Y=new Uint8Array(L),q=0;q<T;q+=4)t=Ae[e.charCodeAt(q)],i=Ae[e.charCodeAt(q+1)],a=Ae[e.charCodeAt(q+2)],O=Ae[e.charCodeAt(q+3)],Y[E++]=t<<2|i>>4,Y[E++]=(15&i)<<4|a>>2,Y[E++]=(3&a)<<6|63&O;return L},Ye={arraybuffer:{test:function(e){return D.toStringTag(e)==="ArrayBuffer"},replace:function(e,t){t.buffers||(t.buffers=[]);var i=t.buffers.indexOf(e);return i>-1?{index:i}:(t.buffers.push(e),xe(e))},revive:function(e,t){if(t.buffers||(t.buffers=[]),u(e)==="object")return t.buffers[e.index];var i=Ge(e);return t.buffers.push(i),i}}},Xe=typeof self>"u"?vt:self,Fe={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(n){var e=n,t=Xe[e];t&&(Fe[n.toLowerCase()]={test:function(a){return D.toStringTag(a)===e},replace:function(a,O){var T=a.buffer,j=a.byteOffset,E=a.length;O.buffers||(O.buffers=[]);var L=O.buffers.indexOf(T);return L>-1?{index:L,byteOffset:j,length:E}:(O.buffers.push(T),{encoded:xe(T),byteOffset:j,length:E})},revive:function(a,O){O.buffers||(O.buffers=[]);var T,j=a.byteOffset,E=a.length,L=a.encoded,Y=a.index;return"index"in a?T=O.buffers[Y]:(T=Ge(L),O.buffers.push(T)),new t(T,j,E)}})});var qe={dataview:{test:function(e){return D.toStringTag(e)==="DataView"},replace:function(e,t){var i=e.buffer,a=e.byteOffset,O=e.byteLength;t.buffers||(t.buffers=[]);var T=t.buffers.indexOf(i);return T>-1?{index:T,byteOffset:a,byteLength:O}:(t.buffers.push(i),{encoded:xe(i),byteOffset:a,byteLength:O})},revive:function(e,t){t.buffers||(t.buffers=[]);var i,a=e.byteOffset,O=e.byteLength,T=e.encoded,j=e.index;return"index"in e?i=t.buffers[j]:(i=Ge(T),t.buffers.push(i)),new DataView(i,a,O)}}},ge={IntlCollator:{test:function(e){return D.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return D.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return D.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function se(n){for(var e=new Uint8Array(n.length),t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer}var te={file:{test:function(e){return D.toStringTag(e)==="File"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad File access: "+t.status);return{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,i=e.type,a=e.stringContents,O=e.lastModified;return new File([se(a)],t,{type:i,lastModified:O})},replaceAsync:function(e){return new D.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result,name:e.name,lastModified:e.lastModified})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}},ue={bigint:{test:function(e){return typeof e=="bigint"},replace:function(e){return String(e)},revive:function(e){return BigInt(e)}}},we={bigintObject:{test:function(e){return u(e)==="object"&&D.hasConstructorOf(e,BigInt)},replace:function(e){return String(e)},revive:function(e){return new Object(BigInt(e))}}},C={cryptokey:{test:function(e){return D.toStringTag(e)==="CryptoKey"&&e.extractable},replaceAsync:function(e){return new D.Promise(function(t,i){crypto.subtle.exportKey("jwk",e).catch(function(a){i(a)}).then(function(a){t({jwk:a,algorithm:e.algorithm,usages:e.usages})})})},revive:function(e){var t=e.jwk,i=e.algorithm,a=e.usages;return crypto.subtle.importKey("jwk",t,i,!0,a)}}};return[Re,y,p,h,d,A,G,{imagedata:{test:function(e){return D.toStringTag(e)==="ImageData"},replace:function(e){return{array:_(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return D.toStringTag(e)==="ImageBitmap"||e&&e.dataset&&e.dataset.toStringTag==="ImageBitmap"},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,createImageBitmap(t)}}},te,{file:te.file,filelist:{test:function(e){return D.toStringTag(e)==="FileList"},replace:function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e.item(i);return t},revive:function(e){return new(function(){function t(){b(this,t),this._files=arguments[0],this.length=this._files.length}return function(a,O,T){return w(a.prototype,O),a}(t,[{key:"item",value:function(a){return this._files[a]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),t}())(e)}}},{blob:{test:function(e){return D.toStringTag(e)==="Blob"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad Blob access: "+t.status);return{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,i=e.stringContents;return new Blob([se(i)],{type:t})},replaceAsync:function(e){return new D.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}}].concat(typeof Map=="function"?H:[],typeof Set=="function"?W:[],typeof ArrayBuffer=="function"?Ye:[],typeof Uint8Array=="function"?Fe:[],typeof DataView=="function"?qe:[],typeof Intl<"u"?ge:[],typeof crypto<"u"?C:[],typeof BigInt<"u"?[ue,we]:[])})}),it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",at=new Uint8Array(256);for(var ct=0;ct<it.length;ct++)at[it.codePointAt(ct)]=ct;var bt=function(v,u,b){b==null&&(b=v.byteLength);for(var w=new Uint8Array(v,0,b),f=w.length,o="",_=0;_<f;_+=3)o+=it[w[_]>>2],o+=it[(w[_]&3)<<4|w[_+1]>>4],o+=it[(w[_+1]&15)<<2|w[_+2]>>6],o+=it[w[_+2]&63];return f%3===2?o=o.slice(0,-1)+"=":f%3===1&&(o=o.slice(0,-2)+"=="),o},Tt=function(v){var u=v.length,b=v.length*.75,w=0,f,o,_,R;v[v.length-1]==="="&&(b--,v[v.length-2]==="="&&b--);for(var s=new ArrayBuffer(b),N=new Uint8Array(s),x=0;x<u;x+=4)f=at[v.codePointAt(x)],o=at[v.codePointAt(x+1)],_=at[v.codePointAt(x+2)],R=at[v.codePointAt(x+3)],N[w++]=f<<2|o>>4,N[w++]=(o&15)<<4|_>>2,N[w++]=(_&3)<<6|R&63;return s},$t=typeof self>"u"?global:self,_t={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(g){var v=g,u=$t[v];u&&(_t[g.toLowerCase()+"2"]={test:function(b){return yt.toStringTag(b)===v},replace:function(b){var w=b.buffer,f=b.byteOffset,o=b.length;return{buffer:w,byteOffset:f,length:o}},revive:function(b){var w=b.buffer,f=b.byteOffset,o=b.length;return new u(w,f,o)}})});var Vt={arraybuffer:{test:function(g){return yt.toStringTag(g)==="ArrayBuffer"},replace:function(g){return bt(g,0,g.byteLength)},revive:function(g){var v=Tt(g);return v}}},Je=new yt().register(Dt),Jt="FileReaderSync"in self,pt=[],ft=0;Je.register([Vt,_t,{blob2:{test:function(g){return yt.toStringTag(g)==="Blob"},replace:function(g){if(g.isClosed)throw new Error("The Blob is closed");if(Jt){var v=At(g,"binary"),u=bt(v,0,v.byteLength);return{type:g.type,data:u}}else{pt.push(g);var b={type:g.type,data:{start:ft,end:ft+g.size}};return ft+=g.size,b}},finalize:function(g,v){g.data=bt(v,0,v.byteLength)},revive:function(g){var v=g.type,u=g.data;return new Blob([Tt(u)],{type:v})}}}]);Je.mustFinalize=function(){return pt.length>0};Je.finalize=function(g){return et(void 0,void 0,void 0,function(){var v,u,b,w,f,o,_,R,s,N,x,oe;return We(this,function(ye){switch(ye.label){case 0:return[4,St(new Blob(pt),"binary")];case 1:if(v=ye.sent(),g){for(u=0,b=g;u<b.length;u++)if(w=b[u],w.$types){f=w.$types,o=f.$,o&&(f=f.$);for(_ in f)R=f[_],s=Je.types[R],s&&s.finalize&&(N=je.getByKeyPath(w,o?"$."+_:_),s.finalize(N,v.slice((x=N.data)===null||x===void 0?void 0:x.start,(oe=N.data)===null||oe===void 0?void 0:oe.end)))}}return pt=[],ft=0,[2]}})})};var Mt=2e3;function mt(g,v){return et(this,void 0,void 0,function(){function u(){return et(this,void 0,void 0,function(){var x,oe,ye,V,J,ee,_e,me,P,Ne;return We(this,function(K){switch(K.label){case 0:return[4,Promise.all(w.map(function(ne){return ne.count()}))];case 1:x=K.sent(),x.forEach(function(ne,re){return o[re].rowCount=ne}),N.totalRows=x.reduce(function(ne,re){return ne+re}),oe=JSON.stringify(R,void 0,_?2:void 0),ye=oe.lastIndexOf("]"),V=oe.substring(0,ye),f.push(V),J=v.filter,ee=v.transform,_e=function(ne){var re,Pe,c,r,m,l,Z,M,ie,ve,Se,Ie;return We(this,function(Ee){switch(Ee.label){case 0:re=g.table(ne),Pe=re.schema.primKey,c=!!Pe.keyPath,r=v.numRowsPerChunk||Mt,m=c?{tableName:re.name,inbound:!0,rows:[]}:{tableName:re.name,inbound:!1,rows:[]},l=JSON.stringify(m,void 0,_?2:void 0),_&&(l=l.split(`
`).join(`
    `)),Z=l.lastIndexOf("]"),f.push(l.substring(0,Z)),M=null,ie=0,ve=!0,Se=function(){var fe,be,ke,Me,D,y,de,Re,p,y;return We(this,function(h){switch(h.label){case 0:return s&&je.ignoreTransaction(function(){return s(N)}),fe=M==null?re.limit(r):re.where(":id").above(M).limit(r),[4,fe.toArray()];case 1:return be=h.sent(),be.length===0?[2,"break"]:(M!=null&&ie>0&&(f.push(","),_&&f.push(`
      `)),ve=be.length===r,c?(ke=J?be.filter(function(d){return J(ne,d)}):be,Me=ee?ke.map(function(d){return ee(ne,d).value}):ke,D=Me.map(function(d){return Je.encapsulate(d)}),Je.mustFinalize()?[4,je.waitFor(Je.finalize(D))]:[3,3]):[3,4]);case 2:h.sent(),h.label=3;case 3:return y=JSON.stringify(D,void 0,_?2:void 0),_&&(y=y.split(`
`).join(`
      `)),f.push(new Blob([y.substring(1,y.length-1)])),ie=Me.length,M=be.length>0?je.getByKeyPath(be[be.length-1],Pe.keyPath):null,[3,8];case 4:return[4,fe.primaryKeys()];case 5:return de=h.sent(),Re=de.map(function(d,A){return[d,be[A]]}),J&&(Re=Re.filter(function(d){var A=d[0],G=d[1];return J(ne,G,A)})),ee&&(Re=Re.map(function(d){var A=d[0],G=d[1],H=ee(ne,G,A);return[H.key,H.value]})),p=Re.map(function(d){return Je.encapsulate(d)}),Je.mustFinalize()?[4,je.waitFor(Je.finalize(p))]:[3,7];case 6:h.sent(),h.label=7;case 7:y=JSON.stringify(p,void 0,_?2:void 0),_&&(y=y.split(`
`).join(`
      `)),f.push(new Blob([y.substring(1,y.length-1)])),ie=Re.length,M=de.length>0?de[de.length-1]:null,h.label=8;case 8:return N.completedRows+=be.length,[2]}})},Ee.label=1;case 1:return ve?[5,Se()]:[3,3];case 2:return Ie=Ee.sent(),Ie==="break"?[3,3]:[3,1];case 3:return f.push(l.substr(Z)),N.completedTables+=1,N.completedTables<N.totalTables&&f.push(","),[2]}})},me=0,P=o,K.label=2;case 2:return me<P.length?(Ne=P[me].name,[5,_e(Ne)]):[3,5];case 3:K.sent(),K.label=4;case 4:return me++,[3,2];case 5:return f.push(oe.substr(ye)),N.done=!0,s&&je.ignoreTransaction(function(){return s(N)}),[2]}})})}var b,w,f,o,_,R,s,N;return We(this,function(x){switch(x.label){case 0:v=v||{},b=v.skipTables?v.skipTables:[],w=g.tables.filter(function(oe){return!b.includes(oe.name)}),f=[],o=w.map(function(oe){return{name:oe.name,schema:Ft(oe),rowCount:0}}),_=v.prettyJson,R={formatName:"dexie",formatVersion:1,data:{databaseName:g.name,databaseVersion:g.verno,tables:o,data:[]}},s=v.progressCallback,N={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:o.length},x.label=1;case 1:return x.trys.push([1,,6,7]),v.noTransaction?[4,u()]:[3,3];case 2:return x.sent(),[3,5];case 3:return[4,g.transaction("r",g.tables,u)];case 4:x.sent(),x.label=5;case 5:return[3,7];case 6:return Je.finalize(),[7];case 7:return[2,new Blob(f,{type:"text/json"})]}})})}var Gt=1,Yt={Stream:function(){}},qt=wt(function(g,v){(function(u){var b=typeof process=="object"&&Ot?Ot:self;u.parser=function(c){return new ye(c)},u.CParser=ye,u.CStream=J,u.createStream=V,u.MAX_BUFFER_LENGTH=10*1024*1024,u.DEBUG=b.CDEBUG==="debug",u.INFO=b.CDEBUG==="debug"||b.CDEBUG==="info",u.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var w={textNode:void 0,numberNode:""},f=u.EVENTS.filter(function(c){return c!=="error"&&c!=="end"}),o=0,_;u.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++};for(var R in u.STATE)u.STATE[u.STATE[R]]=R;o=u.STATE;const s={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(c){function r(){this.__proto__=c}return r.prototype=c,new r}),Object.getPrototypeOf||(Object.getPrototypeOf=function(c){return c.__proto__}),Object.keys||(Object.keys=function(c){var r=[];for(var m in c)c.hasOwnProperty(m)&&r.push(m);return r});function N(c){var r=Math.max(u.MAX_BUFFER_LENGTH,10),m=0;for(var l in w){var Z=c[l]===void 0?0:c[l].length;if(Z>r)switch(l){case"text":closeText(c);break;default:K(c,"Max buffer length exceeded: "+l)}m=Math.max(m,Z)}c.bufferCheckPosition=u.MAX_BUFFER_LENGTH-m+c.position}function x(c){for(var r in w)c[r]=w[r]}var oe=/[\\"\n]/g;function ye(c){if(!(this instanceof ye))return new ye(c);var r=this;x(r),r.bufferCheckPosition=u.MAX_BUFFER_LENGTH,r.q=r.c=r.p="",r.opt=c||{},r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.state=o.BEGIN,r.stack=new Array,r.position=r.column=0,r.line=1,r.slashed=!1,r.unicodeI=0,r.unicodeS=null,r.depth=0,ee(r,"onready")}ye.prototype={end:function(){ne(this)},write:Pe,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{_=Yt.Stream}catch{_=function(){}}function V(c){return new J(c)}function J(c){if(!(this instanceof J))return new J(c);this._parser=new ye(c),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var r=this;_.apply(r),this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(m){r.emit("error",m),r._parser.error=null},f.forEach(function(m){Object.defineProperty(r,"on"+m,{get:function(){return r._parser["on"+m]},set:function(l){if(!l)return r.removeAllListeners(m),r._parser["on"+m]=l,l;r.on(m,l)},enumerable:!0,configurable:!1})})}J.prototype=Object.create(_.prototype,{constructor:{value:J}}),J.prototype.write=function(c){c=new Buffer(c);for(var r=0;r<c.length;r++){var m=c[r];if(this.bytes_remaining>0){for(var l=0;l<this.bytes_remaining;l++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+l]=c[l];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,r=r+l-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&m>=128)if(m>=194&&m<=223&&(this.bytes_in_sequence=2),m>=224&&m<=239&&(this.bytes_in_sequence=3),m>=240&&m<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+r>c.length){for(var Z=0;Z<=c.length-1-r;Z++)this.temp_buffs[this.bytes_in_sequence][Z]=c[r+Z];return this.bytes_remaining=r+this.bytes_in_sequence-c.length,!0}else{this.string=c.slice(r,r+this.bytes_in_sequence).toString(),r=r+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var M=r;M<c.length&&!(c[M]>=128);M++);this.string=c.slice(r,M).toString(),this._parser.write(this.string),this.emit("data",this.string),r=M-1}},J.prototype.end=function(c){return c&&c.length&&this._parser.write(c.toString()),this._parser.end(),!0},J.prototype.on=function(c,r){var m=this;return!m._parser["on"+c]&&f.indexOf(c)!==-1&&(m._parser["on"+c]=function(){var l=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);l.splice(0,0,c),m.emit.apply(m,l)}),_.prototype.on.call(m,c,r)},J.prototype.destroy=function(){x(this._parser),this.emit("close")};function ee(c,r,m){u.INFO&&console.log("-- emit",r,m),c[r]&&c[r](m)}function _e(c,r,m){me(c),ee(c,r,m)}function me(c,r){c.textNode=Ne(c.opt,c.textNode),c.textNode!==void 0&&ee(c,r||"onvalue",c.textNode),c.textNode=void 0}function P(c){c.numberNode&&ee(c,"onvalue",parseFloat(c.numberNode)),c.numberNode=""}function Ne(c,r){return r===void 0||(c.trim&&(r=r.trim()),c.normalize&&(r=r.replace(/\s+/g," "))),r}function K(c,r){return me(c),r+=`
Line: `+c.line+`
Column: `+c.column+`
Char: `+c.c,r=new Error(r),c.error=r,ee(c,"onerror",r),c}function ne(c){return(c.state!==o.VALUE||c.depth!==0)&&K(c,"Unexpected end"),me(c),c.c="",c.closed=!0,ee(c,"onend"),ye.call(c,c.opt),c}function re(c){return c===s.carriageReturn||c===s.lineFeed||c===s.space||c===s.tab}function Pe(c){var r=this;if(this.error)throw this.error;if(r.closed)return K(r,"Cannot write after close. Assign an onready handler.");if(c===null)return ne(r);var m=0,l=c.charCodeAt(0),Z=r.p;for(u.DEBUG&&console.log("write -> ["+c+"]");l&&(Z=l,r.c=l=c.charCodeAt(m++),Z!==l?r.p=Z:Z=r.p,!!l);)switch(u.DEBUG&&console.log(m,l,u.STATE[r.state]),r.position++,l===s.lineFeed?(r.line++,r.column=0):r.column++,r.state){case o.BEGIN:l===s.openBrace?r.state=o.OPEN_OBJECT:l===s.openBracket?r.state=o.OPEN_ARRAY:re(l)||K(r,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(re(l))continue;if(r.state===o.OPEN_KEY)r.stack.push(o.CLOSE_KEY);else if(l===s.closeBrace){ee(r,"onopenobject"),this.depth++,ee(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_OBJECT);l===s.doubleQuote?r.state=o.STRING:K(r,'Malformed object key should start with "');continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(re(l))continue;r.state,o.CLOSE_KEY,l===s.colon?(r.state===o.CLOSE_OBJECT?(r.stack.push(o.CLOSE_OBJECT),me(r,"onopenobject"),this.depth++):me(r,"onkey"),r.state=o.VALUE):l===s.closeBrace?(_e(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE):l===s.comma?(r.state===o.CLOSE_OBJECT&&r.stack.push(o.CLOSE_OBJECT),me(r),r.state=o.OPEN_KEY):K(r,"Bad object");continue;case o.OPEN_ARRAY:case o.VALUE:if(re(l))continue;if(r.state===o.OPEN_ARRAY)if(ee(r,"onopenarray"),this.depth++,r.state=o.VALUE,l===s.closeBracket){ee(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_ARRAY);l===s.doubleQuote?r.state=o.STRING:l===s.openBrace?r.state=o.OPEN_OBJECT:l===s.openBracket?r.state=o.OPEN_ARRAY:l===s.t?r.state=o.TRUE:l===s.f?r.state=o.FALSE:l===s.n?r.state=o.NULL:l===s.minus?r.numberNode+="-":s._0<=l&&l<=s._9?(r.numberNode+=String.fromCharCode(l),r.state=o.NUMBER_DIGIT):K(r,"Bad value");continue;case o.CLOSE_ARRAY:if(l===s.comma)r.stack.push(o.CLOSE_ARRAY),me(r,"onvalue"),r.state=o.VALUE;else if(l===s.closeBracket)_e(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;else{if(re(l))continue;K(r,"Bad array")}continue;case o.STRING:r.textNode===void 0&&(r.textNode="");var M=m-1,ie=r.slashed,ve=r.unicodeI;e:for(;;){for(u.DEBUG&&console.log(m,l,u.STATE[r.state],ie);ve>0;)if(r.unicodeS+=String.fromCharCode(l),l=c.charCodeAt(m++),r.position++,ve===4?(r.textNode+=String.fromCharCode(parseInt(r.unicodeS,16)),ve=0,M=m-1):ve++,!l)break e;if(l===s.doubleQuote&&!ie){r.state=r.stack.pop()||o.VALUE,r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}if(l===s.backslash&&!ie&&(ie=!0,r.textNode+=c.substring(M,m-1),r.position+=m-1-M,l=c.charCodeAt(m++),r.position++,!l))break;if(ie){if(ie=!1,l===s.n?r.textNode+=`
`:l===s.r?r.textNode+="\r":l===s.t?r.textNode+="	":l===s.f?r.textNode+="\f":l===s.b?r.textNode+="\b":l===s.u?(ve=1,r.unicodeS=""):r.textNode+=String.fromCharCode(l),l=c.charCodeAt(m++),r.position++,M=m-1,l)continue;break}oe.lastIndex=m;var Se=oe.exec(c);if(Se===null){m=c.length+1,r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}if(m=Se.index+1,l=c.charCodeAt(Se.index),!l){r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}}r.slashed=ie,r.unicodeI=ve;continue;case o.TRUE:l===s.r?r.state=o.TRUE2:K(r,"Invalid true started with t"+l);continue;case o.TRUE2:l===s.u?r.state=o.TRUE3:K(r,"Invalid true started with tr"+l);continue;case o.TRUE3:l===s.e?(ee(r,"onvalue",!0),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid true started with tru"+l);continue;case o.FALSE:l===s.a?r.state=o.FALSE2:K(r,"Invalid false started with f"+l);continue;case o.FALSE2:l===s.l?r.state=o.FALSE3:K(r,"Invalid false started with fa"+l);continue;case o.FALSE3:l===s.s?r.state=o.FALSE4:K(r,"Invalid false started with fal"+l);continue;case o.FALSE4:l===s.e?(ee(r,"onvalue",!1),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid false started with fals"+l);continue;case o.NULL:l===s.u?r.state=o.NULL2:K(r,"Invalid null started with n"+l);continue;case o.NULL2:l===s.l?r.state=o.NULL3:K(r,"Invalid null started with nu"+l);continue;case o.NULL3:l===s.l?(ee(r,"onvalue",null),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid null started with nul"+l);continue;case o.NUMBER_DECIMAL_POINT:l===s.period?(r.numberNode+=".",r.state=o.NUMBER_DIGIT):K(r,"Leading zero not followed by .");continue;case o.NUMBER_DIGIT:s._0<=l&&l<=s._9?r.numberNode+=String.fromCharCode(l):l===s.period?(r.numberNode.indexOf(".")!==-1&&K(r,"Invalid number has two dots"),r.numberNode+="."):l===s.e||l===s.E?((r.numberNode.indexOf("e")!==-1||r.numberNode.indexOf("E")!==-1)&&K(r,"Invalid number has two exponential"),r.numberNode+="e"):l===s.plus||l===s.minus?(Z===s.e||Z===s.E||K(r,"Invalid symbol in number"),r.numberNode+=String.fromCharCode(l)):(P(r),m--,r.state=r.stack.pop()||o.VALUE);continue;default:K(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&N(r),r}})(v)});function zt(g){var v=0,u=Ht(),b={pullAsync:function(w){return et(this,void 0,void 0,function(){var f,o,_;return We(this,function(R){switch(R.label){case 0:return f=g.slice(v,v+w),v+=w,[4,St(f,"text")];case 1:return o=R.sent(),_=u.write(o),b.result=_||{},[2,_]}})})},pullSync:function(w){var f=g.slice(v,v+w);v+=w;var o=At(f,"text"),_=u.write(o);return b.result=_||{},_},done:function(){return u.done()},eof:function(){return v>=g.size},result:{}};return b}function Ht(g){var v=qt.parser(),u=0,b,w=[],f,o,_=!1,R=!1;return v.onopenobject=function(s){var N={};N.incomplete=!0,b||(b=N),f&&(w.push([o,f,R]),R?f.push(N):f[o]=N),f=N,o=s,R=!1,++u},v.onkey=function(s){return o=s},v.onvalue=function(s){return R?f.push(s):f[o]=s},v.oncloseobject=function(){var s;delete f.incomplete,o=null,--u===0?_=!0:(s=w.pop(),o=s[0],f=s[1],R=s[2])},v.onopenarray=function(){var s=[];s.incomplete=!0,b||(b=s),f&&(w.push([o,f,R]),R?f.push(s):f[o]=s),f=s,R=!0,o=null,++u},v.onclosearray=function(){var s;delete f.incomplete,o=null,--u===0?_=!0:(s=w.pop(),o=s[0],f=s[1],R=s[2])},{write:function(s){return v.write(s),b},done:function(){return _}}}var Et=1024;function gt(g,v){return et(this,void 0,void 0,function(){var u,b,w,f;return We(this,function(o){switch(o.label){case 0:return v=v||{},u=v.chunkSizeBytes||Et*1024,[4,Pt(g,u)];case 1:return b=o.sent(),w=b.result.data,f=new je(v.name!==void 0?v.name:w.databaseName),f.version(w.databaseVersion).stores(Kt(w)),[4,Nt(f,b,v.name!==void 0?lt(lt({},v),{acceptNameDiff:!0}):v)];case 2:return o.sent(),[2,f]}})})}function Nt(g,v,u){return et(this,void 0,void 0,function(){function b(){return et(this,void 0,void 0,function(){var J,ee,_e,me,P;return We(this,function(Ne){switch(Ne.label){case 0:J=function(K){var ne,re,Pe,c,r,m,l,Z,M,ie,ve,Se,Ie;return We(this,function(Ee){switch(Ee.label){case 0:if(s.includes(K.tableName))return[2,"continue"];if(!K.rows)return[2,"break"];if(!K.rows.incomplete&&K.rows.length===0)return[2,"continue"];if(N&&je.ignoreTransaction(function(){return N(x)}),ne=K.tableName,re=g.table(ne),Pe=R.tables.filter(function(fe){return fe.name===ne})[0].schema,!re){if(u.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(K.tableName," is missing in installed database"))}if(!u.acceptChangedPrimaryKey&&Pe.split(",")[0]!=re.schema.primKey.src)throw new Error("Primary key differs for table ".concat(K.tableName,". "));for(c=K.rows,r=[],m=0;m<c.length&&(l=c[m],!l.incomplete);m++)r.push(Je.revive(l));return Z=u.filter,M=u.transform,ie=Z?K.inbound?r.filter(function(fe){return Z(ne,fe)}):r.filter(function(fe){var be=fe[0],ke=fe[1];return Z(ne,ke,be)}):r,M&&(ie=ie.map(K.inbound?function(fe){return M(ne,fe).value}:function(fe){var be=fe[0],ke=fe[1],Me=M(ne,ke,be);return[Me.key,Me.value]})),ve=K.inbound?[void 0,ie]:[ie.map(function(fe){return fe[0]}),r.map(function(fe){return fe[1]})],Se=ve[0],Ie=ve[1],u.overwriteValues?[4,re.bulkPut(Ie,Se)]:[3,2];case 1:return Ee.sent(),[3,4];case 2:return[4,re.bulkAdd(Ie,Se)];case 3:Ee.sent(),Ee.label=4;case 4:return x.completedRows+=r.length,r.incomplete||(x.completedTables+=1),c.splice(0,r.length),[2]}})},ee=0,_e=R.data,Ne.label=1;case 1:return ee<_e.length?(me=_e[ee],[5,J(me)]):[3,4];case 2:if(P=Ne.sent(),P==="break")return[3,4];Ne.label=3;case 3:return ee++,[3,1];case 4:for(;R.data.length>0&&R.data[0].rows&&!R.data[0].rows.incomplete;)R.data.splice(0,1);return!f.done()&&!f.eof()?_?(f.pullSync(w),[3,7]):[3,5]:[3,8];case 5:return[4,je.waitFor(f.pullAsync(w))];case 6:Ne.sent(),Ne.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var w,f,o,_,R,s,N,x,oe,ye,V;return We(this,function(J){switch(J.label){case 0:return u=u||{},w=u.chunkSizeBytes||Et*1024,[4,Pt(v,w)];case 1:if(f=J.sent(),o=f.result,_="FileReaderSync"in self,R=o.data,s=u.skipTables?u.skipTables:[],!u.acceptNameDiff&&g.name!==R.databaseName)throw new Error("Name differs. Current database name is ".concat(g.name," but export is ").concat(R.databaseName));if(!u.acceptVersionDiff&&g.verno!==R.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(g.verno," but export is ").concat(R.databaseVersion));if(N=u.progressCallback,x={done:!1,completedRows:0,completedTables:0,totalRows:R.tables.reduce(function(ee,_e){return ee+_e.rowCount},0),totalTables:R.tables.length},N&&je.ignoreTransaction(function(){return N(x)}),!u.clearTablesBeforeImport)return[3,5];oe=0,ye=g.tables,J.label=2;case 2:return oe<ye.length?(V=ye[oe],s.includes(V.name)?[3,4]:[4,V.clear()]):[3,5];case 3:J.sent(),J.label=4;case 4:return oe++,[3,2];case 5:return u.noTransaction?[4,b()]:[3,7];case 6:return J.sent(),[3,9];case 7:return[4,g.transaction("rw",g.tables,b)];case 8:J.sent(),J.label=9;case 9:return x.done=!0,N&&je.ignoreTransaction(function(){return N(x)}),[2]}})})}function Pt(g,v){return et(this,void 0,void 0,function(){var u,b;return We(this,function(w){switch(w.label){case 0:u="slice"in g?zt(g):g,w.label=1;case 1:return u.eof()?[3,3]:[4,u.pullAsync(v)];case 2:return w.sent(),u.result.data&&u.result.data.data?[3,3]:[3,1];case 3:if(b=u.result,!b||b.formatName!="dexie")throw new Error("Given file is not a dexie export");if(b.formatVersion>Gt)throw new Error("Format version ".concat(b.formatVersion," not supported"));if(!b.data)throw new Error("No data in export file");if(!b.data.databaseName)throw new Error("Missing databaseName in export file");if(!b.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!b.data.tables)throw new Error("Missing tables in export file");return[2,u]}})})}je.prototype.export=function(g){return mt(this,g)};je.prototype.import=function(g,v){return Nt(this,g,v)};je.import=function(g,v){return gt(g,v)};const Wt=jt({__name:"profile",setup(g){const{files:v,open:u}=Ct({accept:"application/json",multiple:!1}),b=()=>{u()};It(v,f=>{if(f&&f.length>0){const o=f[0],_=new FileReader;_.onload=async R=>{var oe;if(!((oe=R.target)!=null&&oe.result))return;const s=R.target.result,N=new Blob([s],{type:"application/json"}),x=await mt(ut,{prettyJson:!0,noTransaction:!0});ut.close(),await je.delete(ut.name);try{await gt(N),alert("Database successfully restored from the backup! Reloading the app"),window.location.reload()}catch(ye){console.error("Restore failed! Attempting to restore from temporary backup...",ye);try{await gt(x),alert("Backup restore failed! Restored to previous state. Reloading the app"),window.location.reload()}catch(V){alert("Backup restore failed! Attempted to restore from the original backup, but that also failed. Please try again."),console.error("Restore from temporary backup failed!",V)}}},_.readAsText(o)}});const w=async()=>{const o=await(await mt(ut,{prettyJson:!0,noTransaction:!0})).text(),_=document.createElement("a");_.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(o)),_.setAttribute("download","backup.json"),_.style.display="none",document.body.appendChild(_),_.click(),document.body.removeChild(_)};return(f,o)=>{const _=Bt;return Lt(),kt(Ut,null,[rt("div",{class:"content"},[o[0]||(o[0]=rt("div",{class:"header"},[rt("h1",null,"Profile/Settings")],-1)),rt("div",{class:"cards-container"},[rt("div",{class:"card",onClick:w},"Backup"),rt("div",{class:"card",onClick:b},"Restore")])]),Rt(_)],64)}}}),nn=xt(Wt,[["__scopeId","data-v-fe6d0917"]]);export{nn as default};
