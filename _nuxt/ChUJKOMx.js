import{_ as E}from"./BciscfNl.js";import{m as L,r as k,g as N,c as n,x as C,a as t,A as S,K as R,F as V,u as $,B,o as i,t as p,_ as T,D as F,E as O,G as P,e as j,b as I,w as U,C as c,H as x,d as q}from"./Cy1DWeqi.js";import{u as G}from"./D7Lzwb-N.js";import{u as K}from"./BWljnZHQ.js";import{u as z}from"./BcjriIf4.js";import"./CAFlqnyI.js";const J={key:1,class:"modal"},Q={class:"modal-controls"},W=["value"],X=L({__name:"attachHabitModal",props:{habits:Object},emits:["selectionMade"],setup(w,{expose:h,emit:g}){const d=w;if(!d.habits)throw new Error("habits prop is required");const a=k(!1),l=k(""),o=k("");N(l,u=>{if(!d.habits)return;const e=Object.keys(d.habits||{}).find(b=>b===u);if(!e)return;let s=d.habits[e].targetDurationSec.toString();s!="0"?o.value=s:o.value=""});const _=g;function M(){l.value="",o.value=""}function v(){if(!l.value){alert("Please select an option.");return}if(o.value==""||o.value=="0"){alert("Please enter a valid duration.");return}if(o.value==null){alert("Please enter a valid durationx.");return}const u={habitId:l.value,durationSec:parseInt(o.value)};_("selectionMade",u),M(),f()}function y(){a.value=!0}function f(){a.value=!1}return h({openModal:y,closeModal:f}),(u,e)=>(i(),n("div",null,[a.value?(i(),n("div",{key:0,class:"modal-overlay",onClick:f})):C("",!0),a.value?(i(),n("div",J,[e[3]||(e[3]=t("h2",{class:"modal-title"},"Choose an Option",-1)),t("div",Q,[S(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s)},[e[2]||(e[2]=t("option",{value:"",disabled:""},"Select...",-1)),(i(!0),n(V,null,$(d.habits,s=>(i(),n("option",{value:s.id},p(s.icon)+" "+p(s.title),9,W))),256))],512),[[R,l.value]]),S(t("input",{type:"number",class:"input-field","onUpdate:modelValue":e[1]||(e[1]=s=>o.value=s),placeholder:"override duration seconds"},null,512),[[B,o.value]])]),t("button",{class:"submit-button",onClick:v},"Submit")])):C("",!0)]))}}),Y=T(X,[["__scopeId","data-v-005eb968"]]),Z={class:"content"},tt={key:0},et={key:1,class:"cards-container"},at=["index"],ot={class:"card-content"},st={class:"habit-icon"},nt={class:"habit-title"},it={class:"habit-duration"},lt={class:"card-actions"},rt=["onClick"],ct={key:2,class:"floating-button"},mt=L({__name:"index",async setup(w){let h,g;const a=F().params.id;if(typeof a!="string")throw[h,g]=O(()=>x("/")),await h,g(),new Error("wrong routine id, not a string");const l=G(),o=l.routines,_=l.routinesLoading,M=P(()=>o.value[a]??null);j(()=>{!_.value&&!o.value[a]&&x("/")});const v=K(),y=v.habitsLoading,f=({habitId:b,durationSec:r})=>{console.log(b,r),l.addHabitInstanceToRoutine(a,b,r)},u=k(null);function e(){u.value?u.value.openModal():console.error("AttachHabitModal is not available yet.")}async function s(){const r=await z().createRoutineLog(a);await x(`/routines/${a}/logs/${r}/run`)}return(b,r)=>{var H;const A=E;return i(),n("div",Z,[I(A,{class:"back-button",to:"/"},{default:U(()=>r[0]||(r[0]=[q("🔙")])),_:1}),c(_)||c(y)?(i(),n("div",tt,"Loading...")):(i(),n("div",et,[t("h1",null,p((H=c(M))==null?void 0:H.title),1),(i(!0),n(V,null,$(c(M).habitInstances,(m,D)=>(i(),n("div",{class:"card",key:m.habitInstanceId,index:D},[t("div",ot,[t("span",st,p(c(v).habits.value[m.habitId].icon),1),t("span",nt,p(c(v).habits.value[m.habitId].title),1),t("span",it,p(m.durationSec)+"sec",1)]),t("div",lt,[r[1]||(r[1]=t("span",{class:"action-button edit-button"},"🖊️",-1)),t("span",{class:"action-button delete-button",onClick:ut=>c(l).removeHabitInstance(c(a),m.habitInstanceId)},"🗑️",8,rt)])],8,at))),128)),t("div",{class:"card add-habit-card",onClick:e},r[2]||(r[2]=[t("div",{class:"card-content"},[t("span",{class:"habit-title"},"+ Attach Habit")],-1)]))])),c(_)?(i(),n("div",ct," ▶️ ")):(i(),n("div",{key:3,class:"floating-button",onClick:s}," ▶️ ")),I(Y,{habits:c(v).habits.value,ref_key:"attachHabitModal",ref:u,onSelectionMade:f},null,8,["habits"])])}}});export{mt as default};
